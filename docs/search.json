[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Compartilhando",
    "section": "",
    "text": "Autor: Prof.¬†Dr.¬†Pedro Rafael D. Marinho\nInstitui√ß√£o: Universidade Federal da Para√≠ba - UFPB\nDepartamento: Departamento de Estat√≠stica - DE\n\nTrata-se de uma p√°gina simples que contei conte√∫dos que eventualmente compartilho com alunos, colegas e com a comunidade em geral. Assim:\n\nN√£o tem objetivo de conter rigor matem√°tico ou estat√≠stico nas explica√ß√µes. √â apenas um espa√ßo para compartilhar ideias e conceitos com pessoas que j√° estou conversando por troca de e-mail, colabora√ß√£o em artigos, orienta√ß√µes, etc;\nCansado de criar reposit√≥rios independ√™ntes para compartilhar algum c√≥digo ou ideias, resolvi criar um √∫nico reposit√≥rio no GitHub para colocar tudo que compartilho em um √∫nico lugar;\nN√£o tem objetivo de ser bonita e bem elaborada."
  },
  {
    "objectID": "page1.html",
    "href": "page1.html",
    "title": "",
    "section": "",
    "text": "Resumo\n\n\n\nA ideia √© mostrar em que situa√ß√£o deveremos considerar a fator de proporcionalidade no processo de otimiza√ß√£o da fun√ß√£o de verossimilhan√ßa/log-verossimilhan√ßa.\nDe forma resumida, devemos apenas nos preocuparmos quando esse fator envolve um ou mais par√¢metros que indexam o nosso modelo. Caso esse fator envolva quantidades fixas que independam dos par√¢metros, n√£o precisaremos nos preocupar com ele."
  },
  {
    "objectID": "page1.html#dados-e-par√¢meteros-verdadeiros",
    "href": "page1.html#dados-e-par√¢meteros-verdadeiros",
    "title": "",
    "section": "Dados e par√¢meteros verdadeiros",
    "text": "Dados e par√¢meteros verdadeiros\nConsidere \\alpha o par√¢metro shape da dweibull() e \\beta o par√¢metro scale da dweibull(), sendo os valores verdadeiros \\alpha = 2.5 e \\beta = 3.5. Vamos gerar os dados que ser√£o sempre os mesmos nos cen√°rios cosiderados adiante nessa an√°lise.\n\n# Garantindo reprodutibilidade, precisamos fixar a semente\n# do gerador de n√∫meros pseudo-aleat√≥rios:\nset.seed(0)\n# Considerando 10 mil observa√ß√µes\ndados &lt;- rweibull(10e3, shape = 2.5, scale = 3.5)"
  },
  {
    "objectID": "page1.html#quando-n√£o-devemos-nos-preocupar",
    "href": "page1.html#quando-n√£o-devemos-nos-preocupar",
    "title": "",
    "section": "Quando n√£o devemos nos preocupar?",
    "text": "Quando n√£o devemos nos preocupar?\nConsideremos o caso da densidade da Weibull (fun√ß√£o dweibull em R). Vamos tornar essa densidade impr√≥pria, isto √©, nesse caso, ela n√£o vai integrar em 1, uma vez que aqui irei dividir essa densidade por uma constante que independe dos par√¢metros, por exemplo, 0.5. Charemos essa fun√ß√£o de pdf_weibull_1().\n\npdf_weibull_1 &lt;- function(x, alpha, beta) {\n  dweibull(x, shape = alpha, scale = beta) / 0.5\n}\n\n# Implementando a verossimilhan√ßa com base em\n# pdf_weibull_1():\nlog_verossimilhanca_1 &lt;- function(x, alpha, beta) {\n  -sum(log(pdf_weibull_1(x, alpha = alpha, beta = beta)))\n}\n\n# Otimizando a fun√ß√£o de log-verossimilhan√ßa:\nemv_1 &lt;- optim(\n  par = c(1, 1),\n  fn = \\(par) log_verossimilhanca_1(x = dados, alpha = par[1L], beta = par[2L]),\n  method = \"Nelder-Mead\"\n)\n\n# Exibindo o resultado:\nprint(emv_1)\n\n$par\n[1] 2.470489 3.502528\n\n$value\n[1] 9996.28\n\n$counts\nfunction gradient \n      77       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nAssim, nossas estimativas par \\alpha e beta, foram respectivamente \\widehat{\\alpha} = 2.4704888 e \\widehat{\\beta} = 3.5025281, muito pr√≥ximas aos valores verdadeiros \\alpha = 2.5 e \\beta = 3.5.\nPerceba que nossa verossimilhan√ßa n√£o considerou o fator de proporcionalidade, uma vez que ele n√£o depende dos par√¢metros. Em nenhum momento houve a preocupa√ß√£o com esse fator, pois ele √© constante a todo momento, por n√£o envolver \\alpha nem \\beta.\n\n\n\nOk?"
  },
  {
    "objectID": "page1.html#quando-devo-me-preocupar-com-o-fator-de-proporcionalidade",
    "href": "page1.html#quando-devo-me-preocupar-com-o-fator-de-proporcionalidade",
    "title": "",
    "section": "Quando devo me preocupar com o fator de proporcionalidade?",
    "text": "Quando devo me preocupar com o fator de proporcionalidade?\nBem, como dito anteriormente, devemos nos preocupar com o fator de proporcionalidade quando ele envolve um ou mais par√¢metros que indexam o nosso modelo. Vamos considerar a densidade da Weibull (fun√ß√£o dweibull() e iremos multiplicar ela por, por exemplo, \\frac{\\alpha}{\\beta}). Chamaremos essa fun√ß√£o de pdf_weibull_2().\nForma ing√™nua\nIngenuamente, vamos implementar a verossimilhan√ßa com base em pdf_weibull_2(), sem nos preocuparmos com o fator de proporcionalidade. Lembre-se, agora, esse fator envolve os par√¢metros \\alpha e \\beta do modelo, mas n√£o iremos nos preocupara ingenuamente com eles.\n\npdf_weibull_2 &lt;- function(x, alpha, beta) {\n  dweibull(x, shape = alpha, scale = beta) * (alpha / beta)\n}\n\n# Implementando a verossimilhan√ßa com base em\n# pdf_weibull_1():\nlog_verossimilhanca_2 &lt;- function(x, alpha, beta) {\n  -sum(log(pdf_weibull_2(x, alpha = alpha, beta = beta)))\n}\n\n# Otimizando a fun√ß√£o de log-verossimilhan√ßa:\nemv_2 &lt;- optim(\n  par = c(1, 1),\n  fn = \\(par) log_verossimilhanca_2(x = dados, alpha = par[1L], beta = par[2L]),\n  method = \"Nelder-Mead\"\n)\n\n# Exibindo o resultado:\nprint(emv_2)\n\n$par\n[1] 3.466101 3.467659\n\n$value\n[1] 18407.21\n\n$counts\nfunction gradient \n      79       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nPerceba que as estimativas, agora, n√£o foram coerentes, uma vez que n√£o consideramos o fator de proporcionalidade que envolve os par√¢metros \\alpha e \\beta. As estimativas \\widehat{\\alpha} = 3.4661009 e \\widehat{\\beta} = 3.4676589 n√£o foram pr√≥ximas aos valores verdadeiros \\alpha = 2.5 e \\beta = 3.5."
  },
  {
    "objectID": "page1.html#forma-coerente-se-preocumando-com-o-fator-de-proporcionalidade",
    "href": "page1.html#forma-coerente-se-preocumando-com-o-fator-de-proporcionalidade",
    "title": "",
    "section": "Forma coerente (se preocumando com o fator de proporcionalidade)",
    "text": "Forma coerente (se preocumando com o fator de proporcionalidade)\nQuando o fator de proporcionalidade envolve os par√¢metros do modelo, devemos nos preocupar com ele. Note que pdf_weibuul_3() √© uma densidade impr√≥pria, uma vez que ela n√£o integra em 1, de modo que ela √© multiplicada por \\frac{\\alpha}{\\beta}. Vamos implementar a verossimilhan√ßa com base nessa densidade, mas, agora, consideraremos o fator de proporcionalidade na implementa√ß√£o da verossmilhan√ßa, ou seja, iremos multiplicar pdf_weibull_3() por \\frac{\\beta}{\\alpha}, na verossimilhan√ßa!\n\npdf_weibull_3 &lt;- function(x, alpha, beta) {\n  dweibull(x, shape = alpha, scale = beta) * (alpha / beta)\n}\n\n# Implementando a verossimilhan√ßa com base em\n# pdf_weibull_3():\nlog_verossimilhanca_3 &lt;- function(x, alpha, beta) {\n  fator_normalizacao &lt;- beta / alpha\n  -sum(log(pdf_weibull_3(x, alpha = alpha, beta = beta) * fator_normalizacao))\n}\n\n# Otimizando a fun√ß√£o de log-verossimilhan√ßa:\nemv_3 &lt;- optim(\n  par = c(1, 1),\n  fn = \\(par) log_verossimilhanca_3(x = dados, alpha = par[1L], beta = par[2L]),\n  method = \"Nelder-Mead\"\n)\n\n# Exibindo o resultado:\nprint(emv_3)\n\n$par\n[1] 2.470489 3.502528\n\n$value\n[1] 16927.75\n\n$counts\nfunction gradient \n      77       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n\n\nAgora sim, temos estimativas coerente para uma verossimilhan√ßa proporcional que envolve os par√¢metros do nosso modelo! As estimativas \\widehat{\\alpha} = 2.4704888 e \\widehat{\\beta} = 3.5025281 foram muito pr√≥ximas aos valores verdadeiros \\alpha = 2.5 e \\beta = 3.5.\n\n\nEntendido esse ponto? Quando o fator de proporcionalidade envolve os par√¢metros do modelo, devemos nos preocupar com ele. Caso contr√°rio, podemos ignor√°-lo, uma vez que ele √© constante e n√£o depende dos par√¢metros do modelo."
  },
  {
    "objectID": "page2.html",
    "href": "page2.html",
    "title": "S√©rie de Taylor, c√≥digo espaguete e outras coisas",
    "section": "",
    "text": "Uma boa forma de desenvolver flu√™ncia em uma linguagem de programa√ß√£o √© se submeter a resolver problemas utilizando a linguagem que voc√™ deseja aprender. Para quem tem interesse em trabalhar com computa√ß√£o cient√≠fica, um exerc√≠cio muito interessante √© selecionar alguns problemas b√°sicos na sua √°rea de atua√ß√£o e tentar resolver! Tente entender bem o problema a ser resolvido e se submeta ao exerc√≠cio de implementar uma fun√ß√£o da forma mais gen√©rica poss√≠vel.\nEsse t√≥pico sugiro meio que por acaso. Na verdade, eu estava na sala de aula, explicando aos meus alunos sobre funcionais em R e dizia a eles que nem sempre precisamos utilizar instru√ß√µes de repeti√ß√£o como for, while e repeat para repetir trechos de c√≥digos, e na aula usei o exemplo das s√©ries de Taylor. Tanto na aula, quanto aqui, deixo claro que s√©ries de Taylor n√£o √© o tema principal, muito embora o t√≠tulo da postagem possa talvez te confundir a respeito do prop√≥sito dessa postagem.\nO maior objetivo √© fazer com que voc√™ possa estudar o c√≥digo e entender os recursos utilizados para se chegar a solu√ß√£o. Procure entender o papel do funcional sapply(), da fun√ß√£o do.call(), do operador dot-dot-dot ... e do uso de fun√ß√£o an√¥nima no funcional sapply(). Esses s√£o basicamente os principais pontos do c√≥digo.\nTodavia, √© claro que eu terei que definir brevemente o que √© uma s√©rie de Taylor. Afinal, precisamos compreender, de forma clara, o que o c√≥digo tenta implementar. Tudo bem?! ü§ù\nCompreender de forma cristalina o problema √© a chave üîê para desenvolver, de forma consistente, um c√≥digo coerente e reaproveit√°vel. Tente evitar o c√≥digo espaguete, em que voc√™ at√© resolve o problema, por√©m, o reaproveitamento de c√≥digo e a manuten√ß√£o do mesmo se torna muito desafiador! Fuja desses tipos de implementa√ß√µes e projetos, pois estes n√£o acrescentam muito no seu aprendizado de programa√ß√£o.\nUma √≥tima postagem que encontrei na internet e que poder√° ser √∫til para voc√™ entender sobre a import√¢ncia de se afastar de c√≥digo espaguete, em R, poder√° ser acessada clicando AQUI. E n√£o se engane, apesar do termo engra√ßado (c√≥digo espaguete), h√° diversos livros na computa√ß√£o sobre o tema."
  },
  {
    "objectID": "page2.html#s√©rie-de-taylor",
    "href": "page2.html#s√©rie-de-taylor",
    "title": "S√©rie de Taylor, c√≥digo espaguete e outras coisas",
    "section": "S√©rie de Taylor",
    "text": "S√©rie de Taylor\nEm matem√°tica, uma s√©rie de Taylor √© uma soma de fun√ß√µes, de tal forma que\n\\[f(x) = \\sum_{n = 0}^{\\infty} a_n(x-a)^n,\\] com\n\\[a_n = \\frac{f^{(n)}(a)}{n!},\\] em que \\(f^{(n)}(a)\\) √© a \\(n\\)-√©sima derivada da fun√ß√£o \\(f\\) (supostamente sendo infinitamente diferenci√°vel) avaliada no ponto \\(a\\). Para o caso de \\(a = 0\\), essa aproxima√ß√£o √© denominada de s√©rie de Maclaurin.\nPor exemplo, considerado \\(a = 0\\), poderemos aproximar \\(f(x) = e^x\\), em torno de \\(a = 0\\) por meio da express√£o abaixo:\n\\[e^x \\approx \\sum_{n = 0}^N \\frac{x^n}{n!},\\] com \\(N &lt; \\infty\\).\n\n\n\n\n\nNote que temos uma √≥tima aproxima√ß√£o de \\(f(x)\\), em torno de \\(a = 0\\), por meio do polin√¥mio de Taylor, considerando \\(N = 2\\)."
  },
  {
    "objectID": "page2.html#implementa√ß√£o",
    "href": "page2.html#implementa√ß√£o",
    "title": "S√©rie de Taylor, c√≥digo espaguete e outras coisas",
    "section": "Implementa√ß√£o",
    "text": "Implementa√ß√£o\nN√£o irei discutir, nos por menores, a implementa√ß√£o do c√≥digo, pois certamente seria enfadonho. Estudar o c√≥digo ‚Äún√£o espaguete‚Äù üçù de outra pessoa √© uma boa forma de adquirir conhecimento. O GitHub est√° a√≠ para voc√™ estudar um universo de c√≥digos e melhorar suas pr√°ticas de programa√ß√£o, seja em R ou qualquer outra linguagem de programa√ß√£o.\nO que eu basicamente fiz foi implementar duas fun√ß√µes:\n\nA fun√ß√£o taylor(n = 1L, func, x, a = 0,...) que recebe o n√∫mero de somas n, a fun√ß√£o func a ser aproximada, um valor x e o valor de a. Tamb√©m √© poss√≠vel passar argumentos adicionais usando o operador varargs dot-dot-dot (...), em que voc√™ poder√° controlar argumentos da fun√ß√£o Deriv() do pacote Deriv utilizado para o c√°lculo das derivadas simb√≥licas de \\(f(x)\\). O pacote encontra-se no Comprehensive R Archive Network - CRAN e poder√° ser instalado fazendo install.packages(\"Deriv\")(Clausen and Sokol 2020);\nA fun√ß√£o plot_taylor(n, func, lower, upper, a) que permitir√° que possamos visualizar graficamente a aproxima√ß√£o. Temos que n √© a quantidade de somas utilizadas na aproxima√ß√£o, func √© a fun√ß√£o que desejamos aproximar, lower √© o limite inferior do eixo x, upper √© o limite superior do eixo \\(x\\) e a √© o ponto onde tentaremos uma boa aproxima√ß√£o em seu entorno.\n\nNote que, em R, fun√ß√µes s√£o objetos de primeira classe. Isso quer dizer que, podemos criar uma fun√ß√£o dentro de outra fun√ß√£o e, sobretudo, poderemos ter uma fun√ß√£o retornando uma fun√ß√£o, como √© o caso da fun√ß√£o an() definida em taylor(). Note que a fun√ß√£o an() retorna a fun√ß√£o que implementa a derivada de func.\n\n# S√©rie de Taylor ---------------------------------------------------------\ntaylor &lt;- function(n = 1L, func, x, a = 0,...){\n  an &lt;- function(n, ...){\n    Deriv::Deriv(f = func, nderiv = n, ...)\n  }\n\n  if(n == 1L)\n    return(func(a))\n\n  sapply(\n    X = 1L:n,\n    FUN = \\(n, x) do.call(an(n, ...), list(x = x))/factorial(n) * (x - a)^n,\n    x = x\n  ) |&gt; sum() + func(a)\n}\n\n# Testando a fun√ß√£o taylor().\ntaylor(n = 2L, func = \\(x) x^2, x = 0.5, a = 0)\n\n[1] 0.75\n\n\n\n\n\n\n\n\nDerivadas simb√≥licas\n\n\n\nConhecer derivadas de fun√ß√µes √© algo muito corriqueiro na computa√ß√£o cient√≠fica. Com o pacote Deriv voc√™ n√£o precisa se preocupar em derivar simbolicamente (analiticamente) as \\(n\\)-√©simas derivadas de uma fun√ß√£o.\n\nlibrary(Deriv)\n\n# Derivando simbolicamente log(1-sin(x)). Perceba que\n#  o retorno √© uma fun√ß√£o R em termos de x.\nDeriv(f = \\(x) log(1-sin(x)))\n\nfunction (x) \n-(cos(x)/(1 - sin(x)))\n\n\n√â importante destacar que a obten√ß√£o de derivadas simb√≥licas s√£o mais custosas que os m√©todos num√©ricos de deriva√ß√£o, sobretudo quando temos interesse de obter ordens elevadas de deriva√ß√£o. Mesmo assim, irei utilizar aqui a biblioteca Deriv, que poder√° ser bastante √∫til em diversas situa√ß√µes. Para a obten√ß√£o de derivadas num√©ricas, estude a biblioteca numDeriv (Gilbert and Varadhan 2019).\n\n\nVisualizar graficamente os resultados de uma fun√ß√£o poder√° nos ajudar na valida√ß√£o da implementa√ß√£o. Comportamentos inadequados na fun√ß√£o taylor() seriam facilmente percebidos ao utilizar a fun√ß√£o plot_taylor().\n\nlibrary(ggplot2)\nlibrary(glue)\nlibrary(patchwork)\n\nplot_taylor &lt;- function(n = 1L, func, a, lower = -1, upper = 1, ...){\n  x &lt;- seq(lower, upper, length.out = 100L)\n  y &lt;- func(x)\n\n  y_taylor &lt;-\n    sapply(\n      X = x,\n      FUN = \\(x) taylor(n = n, func = func, x = x, a = a, ...)\n    )\n\n  data.frame(\n    x = c(x, x),\n    y = c(y, y_taylor),\n    classe = c(rep(\"f(x)\", 100L), rep(\"Taylor\", 100L))\n  ) |&gt;\n    ggplot() +\n    geom_line(aes(x = x, y = y, color = classe), size = 0.9) +\n    geom_point(x = a, y = func(a), color = \"blue\", size = 2) +\n    ggtitle(\n      label = \"S√©rie de Taylor\",\n      subtitle = glue(\"Aproxima√ß√£o de uma fun√ß√£o f(x)\\n n = {n}\")\n    ) +\n    ylab(\"f(x)\") +\n    scale_color_manual(values = c(\"black\", \"tomato\")) +\n    theme(\n      text = element_text(face = \"bold\")\n    ) +\n    labs(color = \"\")\n}\n\n# Aproximando func em torno de \"a\" ----------------------------------------\np1 &lt;- plot_taylor(\n  n = 3,\n  func = \\(x) exp(x),\n  lower = -1,\n  upper = 1,\n  a = 0.5\n)\n\np2 &lt;- plot_taylor(\n  n = 3,\n  func = \\(x) x^3,\n  lower = -1,\n  upper = 1,\n  a = 0.5\n)\n\np3 &lt;- plot_taylor(\n  n = 3,\n  func = \\(x) 3*x^3 + 4*x^2,\n  lower = -1,\n  upper = 1,\n  a = 0\n)\n\np4 &lt;- plot_taylor(\n  n = 3,\n  func = \\(x) 15*x^2 - 14*x + 7,\n  lower = -0.8,\n  upper = 2,\n  a = 1.5\n)\n\n(p1 + p2)/(p3 + p4) + plot_annotation(tag_levels = \"I\")"
  }
]